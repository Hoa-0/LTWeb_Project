<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security"> <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title layout:title-pattern="$LAYOUT_TITLE - $CONTENT_TITLE">Alotra Admin</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.13.6/css/dataTables.bootstrap5.min.css">
    <link rel="stylesheet" th:href="@{/css/admin-custom.css}"> <style>
        .sidebar {
            min-height: 100vh;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            box-shadow: 2px 0 10px rgba(0,0,0,0.1);
        }
        .sidebar .nav-link {
            color: rgba(255,255,255,0.8);
            padding: 0.75rem 1.5rem;
            border-radius: 10px;
            margin: 0.25rem 1rem;
            transition: all 0.3s ease;
        }
        .sidebar .nav-link:hover,
        .sidebar .nav-link.active {
            background: rgba(255,255,255,0.2);
            color: white;
            transform: translateX(5px);
        }
        .main-content {
            background-color: #f8f9fa;
            min-height: 100vh;
            padding-top: 56px; /* Chi·ªÅu cao c·ªßa navbar */
        }
        .navbar-admin-top {
            background: white;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            position: fixed; /* Fix navbar tr√™n c√πng */
            top: 0;
            left: auto; /* ƒê·ªÉ kh√¥ng b·ªã ·∫£nh h∆∞·ªüng b·ªüi sidebar */
            right: 0;
            z-index: 1030; /* ƒê·∫£m b·∫£o navbar n·ªïi l√™n tr√™n */
            width: calc(100% - var(--sidebar-width, 250px)); /* Chi·ªÅu r·ªông b·∫±ng ph·∫ßn content */
        }
        /* ƒêi·ªÅu ch·ªânh chi·ªÅu r·ªông navbar khi sidebar collapse (n·∫øu l√†m responsive) */
         @media (max-width: 767.98px) {
             .navbar-admin-top {
                 width: 100%;
             }
         }
        .avatar {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: rgba(255,255,255,0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: white;
        }
        /* Style cho DataTables (c√≥ th·ªÉ ƒë·ªÉ trong file css ri√™ng) */
        .dataTables_wrapper .dataTables_paginate .paginate_button {
            padding: 0.3em 0.8em;
        }
        .dataTables_wrapper .dataTables_filter input {
            margin-left: 0.5em;
        }
        /* T√πy ch·ªânh chi·ªÅu r·ªông sidebar */
        :root {
            --sidebar-width: 250px; /* ƒêi·ªÅu ch·ªânh n·∫øu c·∫ßn */
        }
        .sidebar {
            width: var(--sidebar-width);
        }
         /* Style cho Toast (th√¥ng b√°o nh·ªè) */
         .toast-container {
             z-index: 1090; /* ƒê·∫£m b·∫£o toast n·ªïi l√™n tr√™n modal */
         }

    </style>
</head>
<body>
    <div class="container-fluid">
        <div class="row">
            <nav id="sidebarMenu" class="col-md-3 col-lg-2 d-md-block sidebar collapse" style="width: var(--sidebar-width);">
                <div class="position-sticky pt-3">
                 <!-- üîπ Logo th∆∞∆°ng hi·ªáu -->
    <div class="text-center py-3 border-bottom">
        <a th:href="@{/admin/dashboard}" class="d-flex justify-content-center align-items-center text-decoration-none">
            <img th:src="@{/images/logo.jpg}" alt="AloTra Logo" style="height: 60px; border-radius: 10px;">
        </a>
    </div>
                    <div class="text-center p-3">
                        <div class="avatar mx-auto mb-2">
                            <i class="fas fa-user-shield"></i>
                        </div>
                        <h6 class="text-white" sec:authentication="principal.username">T√™n ƒêƒÉng Nh·∫≠p</h6>
                        <small class="text-white-50">Qu·∫£n tr·ªã vi√™n</small> </div>

                    <ul class="nav flex-column">
                        <li class="nav-item">
                            <a class="nav-link" th:href="@{/admin/dashboard}"
                               th:classappend="${requestURI != null && #strings.startsWith(requestURI, '/admin/dashboard')} ? 'active'">
                                <i class="fas fa-tachometer-alt me-2"></i> Dashboard
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" th:href="@{/admin/employees}"
                               th:classappend="${requestURI != null && #strings.startsWith(requestURI, '/admin/employees')} ? 'active'">
                                <i class="fas fa-users-cog me-2"></i> Qu·∫£n l√Ω nh√¢n vi√™n
                            </a>
                        </li>
                        <li class="nav-item">
                             <a class="nav-link" th:href="@{/admin/customers}"
                                th:classappend="${requestURI != null && #strings.startsWith(requestURI, '/admin/customers')} ? 'active'">
                                 <i class="fas fa-users me-2"></i> Qu·∫£n l√Ω kh√°ch h√†ng
                             </a>
                         </li>
                         <li class="nav-item">
                             <a class="nav-link" th:href="@{/admin/categories}"
                                th:classappend="${requestURI != null && #strings.startsWith(requestURI, '/admin/categories')} ? 'active'">
                                 <i class="fas fa-tags me-2"></i> Qu·∫£n l√Ω danh m·ª•c
                             </a>
                         </li>
                        <li class="nav-item">
                            <a class="nav-link" th:href="@{/admin/products}"
                               th:classappend="${requestURI != null && #strings.startsWith(requestURI, '/admin/products')} ? 'active'">
                                <i class="fas fa-box me-2"></i> Qu·∫£n l√Ω s·∫£n ph·∫©m
                            </a>
                        </li>
                         <li class="nav-item">
                             <a class="nav-link" th:href="@{/admin/promotions}"
                                th:classappend="${requestURI != null && #strings.startsWith(requestURI, '/admin/promotions')} ? 'active'">
                                 <i class="fas fa-gift me-2"></i> Qu·∫£n l√Ω khuy·∫øn m√£i
                             </a>
                         </li>

                         <li class="nav-item">
                            <a class="nav-link" th:href="@{/admin/reports/revenue}"
                               th:classappend="${requestURI != null && #strings.startsWith(requestURI, '/admin/reports')} ? 'active'">
                                <i class="fas fa-chart-line me-2"></i> B√°o c√°o Doanh thu
                            </a>
                         </li>

                    </ul>
                </div>
            </nav>

            <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4 main-content" style="margin-left: var(--sidebar-width); width: calc(100% - var(--sidebar-width));">
                <nav class="navbar navbar-expand-lg navbar-light navbar-admin-top">
                    <div class="container-fluid">
                         <button class="navbar-toggler d-md-none collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#sidebarMenu" aria-controls="sidebarMenu" aria-expanded="false" aria-label="Toggle navigation">
                             <span class="navbar-toggler-icon"></span>
                         </button>

                         <h4 class="navbar-brand mb-0" layout:fragment="page_title">Trang Qu·∫£n Tr·ªã</h4>

                        <div class="navbar-nav ms-auto">
                            <div class="nav-item dropdown">
                                <a class="nav-link dropdown-toggle d-flex align-items-center" href="#" role="button" data-bs-toggle="dropdown">
                                    <i class="fas fa-user-circle fa-lg me-2"></i>
                                    <span sec:authentication="principal.username">T√™n Admin</span>
                                </a>
                                <ul class="dropdown-menu dropdown-menu-end">
                                    <li><a class="dropdown-item" href="#"><i class="fas fa-user me-2"></i>H·ªì s∆°</a></li>
                                    <li><a class="dropdown-item" href="#"><i class="fas fa-cog me-2"></i>C√†i ƒë·∫∑t</a></li>
                                    <li><hr class="dropdown-divider"></li>
                                    <li>
                                        <form th:action="@{/admin/logout}" method="post" id="logoutFormAdmin" style="display: none;">
                                            </form>
                                        <a class="dropdown-item" href="#"
                                           onclick="event.preventDefault(); document.getElementById('logoutFormAdmin').submit();">
                                            <i class="fas fa-sign-out-alt me-2"></i>ƒêƒÉng xu·∫•t
                                        </a>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </nav>

                <div class="container-fluid py-4">
                    <div layout:fragment="content">
                        <p>ƒê√¢y l√† n·ªôi dung ch√≠nh.</p>
                    </div>
                </div>

                 <div class="toast-container position-fixed bottom-0 end-0 p-3">
                     </div>

            </main>
        </div>
    </div>
	<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
    <script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.13.6/js/dataTables.bootstrap5.min.js"></script>
    <script th:src="@{/js/admin-custom.js}"></script>

     <th:block layout:fragment="scripts">
         </th:block>

     <script>
         function showToast(message, type = 'success') {
             const toastContainer = document.querySelector('.toast-container');
             const toastId = 'toast-' + Date.now();
             const toastBg = type === 'success' ? 'bg-success' : (type === 'danger' ? 'bg-danger' : 'bg-info');
             const toastIcon = type === 'success' ? 'fa-check-circle' : (type === 'danger' ? 'fa-exclamation-triangle' : 'fa-info-circle');

             const toastHtml = `
                 <div id="${toastId}" class="toast align-items-center text-white ${toastBg} border-0" role="alert" aria-live="assertive" aria-atomic="true">
                     <div class="d-flex">
                         <div class="toast-body">
                             <i class="fas ${toastIcon} me-2"></i>
                             ${message}
                         </div>
                         <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="Close"></button>
                     </div>
                 </div>
             `;
             toastContainer.insertAdjacentHTML('beforeend', toastHtml);
             const toastElement = document.getElementById(toastId);
             const toast = new bootstrap.Toast(toastElement, { delay: 5000 }); // T·ª± ·∫©n sau 5 gi√¢y
             toast.show();
             // X√≥a toast kh·ªèi DOM sau khi ·∫©n ƒë·ªÉ tr√°nh t√≠ch t·ª•
             toastElement.addEventListener('hidden.bs.toast', () => {
                 toastElement.remove();
             });
         }
     </script>

</body>
</html>